# OAuth 2.0 实战课

### 开篇词 | 为什么要学 OAuth 2.0？

### 01 | OAuth 2.0 是要通过什么方式解决什么问题？

OAuth 2.0 这种授权协议，就是保证第三方（软件）只有在获得授权之后，才可以进一步访问授权者的数据。

OAuth 2.0 的核心是授权许可，更进一步说就是令牌机制。

### 02 | 授权码许可类型中，为什么一定要有授权码？

***为什么需要授权码？***

在 OAuth 2.0 的体系里面有 4 种角色，它们分别是资源拥有者、客户端、授权服务和受保护资源。

![授权码许可流程](授权码许可流程.jpg)

***授权码许可类型的通信过程***

间接通信是指获取授权码的交互，而直接通信是指通过授权码换取访问令牌的交互。

OAuth 2.0 中的 4 个角色是“两两站队”的：资源拥有者和第三方软件“站在一起”，因为第三方软件要代表资源拥有者去访问受保护资源；授权服务和受保护资源“站在一起”，因为授权服务负责颁发访问令牌，受保护资源负责接收并验证访问令牌。

***一定要有浏览器吗？***

OAuth 2.0 是一个授权理念，或者说是一种授权思维。

开发者通过 wx.login(Object object) 方法获取到登录凭证 code 值，这一步的流程是在小程序内部通过调用微信提供的 SDK 实现；

通过该 code 值换取用户的 session_key 等信息，也就是官方文档的 auth.code2Session 方法，同时该方法也是被强烈建议通过开发者的后端服务来调用的。

***总结***

在 OAuth 2.0 中，访问令牌被要求有极高的安全保密性，因此我们不能让它暴露在浏览器上面，只能通过第三方软件的后端服务来获取和使用，以最大限度地保障访问令牌的安全性。正因为访问令牌的这种安全要求特性，当需要前端通信（比如在浏览器上面流转）的时候，OAuth 2.0 才又提供了一个临时的凭证：授权码。通过授权码的方式，可以让用户在授权服务上给第三方软件授权之后，还能重新回到第三方软件的操作页面上。这样，在保障安全性的情况下，提升了用户的体验。